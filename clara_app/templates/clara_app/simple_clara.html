{% extends 'clara_app/base.html' %}

{% block content %}

  <h2>Simple C-LARA</h2>
  <form method="post" enctype="multipart/form-data">
    {% csrf_token %}
	<h3>Project name</h3>
	<p>{{ form.title }}
	{% if status != 'No project' %}
      <button type="submit" name="action" value="change_title">Change title</button>
    {% endif %}</p>
    {% if status == 'No project' %}
	  <h3>Languages</h3>
	  <p>Text language: {{ form.l2 }}</p>
	  <p>Annotation language: {{ form.l1 }}</p>
      <button type="submit" name="action" value="create_project">Create Project</button>
    {% endif %}
	{% if status != 'No project' %}
	   <h3>Prompt</h3>
	   <p>{{ form.prompt }}</p>
	{% endif %}
	{% if status == 'No prompt' or status == 'No text' %}
      <button type="submit" name="action" value="create_text_and_image">Create Text and Image</button>
    {% endif %}
	
	{% if status != 'No project' and status != 'No prompt' and status != 'No text' %}
	  <h3>Generated text title</h3>
	  <p>{{ form.text_title }}
	     <button type="submit" name="action" value="save_text_title">Save Edited Text Title</button></p>
	  <h3>Generated text</h3>
	  <p>{{ form.plain_text }}
	     <button type="submit" name="action" value="save_text">Save Edited Text</button>
	     <button type="submit" name="action" value="rewrite_text">Rewrite Text</button></p>
	  <br>
    {% endif %}
    {% if status == 'No multimedia' or status == 'Everything available' or status == 'Posted' %}
	  <h3>Image</h3>
      <p><img src="{% url 'serve_project_image' form.internal_title.value form.image_basename.value %}" alt="Generated Image" style="max-width: 300px; max-height: 300px;">
	  <button type="submit" name="action" value="regenerate_image">Regenerate Image</button><p>
	{% elif status == 'No image' or status == 'Everything available except image' or status == 'Posted without image' %}
	   <h3>Image</h3>
	   <p>Image generation failed, probably due to constraints on appropriate content. Sometimes adding advice in the box below and regenerating will fix this.</p>
	   <p>{{ form.image_advice_prompt }} <button type="submit" name="action" value="regenerate_image">Regenerate Image</button><p>
    {% endif %}
	{% if status == 'No multimedia' or status == 'Everything available' or status == 'Posted' or status == 'No image' or status == 'Everything available except image' or status == 'Posted without image' %}
	   <h3>Uploaded image (alternative to AI-generated image)</h3>
	   <p>{{ form.image_file_path }} <button type="submit" name="action" value="save_uploaded_image">Save Uploaded Image</button><p>
	{% endif %}
  
    {% if status == 'No image' or status == 'No multimedia' or status == 'Everything available' or status == 'Everything available except image' or status == 'Posted' or status == 'Posted without image' %}
	  {% if status == 'Everything available' or status == 'Everything available except image' or status == 'Posted' or status == 'Posted without image' %}
	    <h3>Segmented text</h3>
		<p>{{ form.segmented_text }}
	    <button type="submit" name="action" value="save_segmented_text">Save Edited Segmented Text</button>
		<br>
	  {% endif %}
	  <h3>Multimedia text</h3>
	  {% if status != 'No image' and status != 'No multimedia' %}
	    <p><a href="{% url 'serve_rendered_text' project_id 'normal' 'page_1.html' %}" target="_blank">View Rendered Content</a></p>
	  {% endif %}
	  {% if status == 'No image' or status == 'No multimedia' %}
        <button type="submit" name="action" value="create_rendered_text">Generate Multimedia Text</button>
	  {% else %}
      <p><button type="submit" name="action" value="create_rendered_text">Regenerate Multimedia Text</button><p>
	  {% endif %}
    {% endif %}
	
	{% if status == 'Everything available' or status == 'Everything available except image' or status == 'Posted' or status == 'Posted without image' %}
	  <h3>C-LARA Social Network</h3>
	  {% if status == 'Everything available' or status == 'Everything available except image' %}
        <button type="submit" name="action" value="post_rendered_text">Post to Social Network</button>
	  {% else %}
	    <p><a href="{{ content.get_absolute_url }}" target="_blank">View Social Network Page</a></p>
	  {% endif %}
    {% endif %}
  </form>
  {% if status != 'No project' %}
    <br>
    <p><a href="{% url 'project_detail' project_id %}"><strong>[View project in full C-LARA]</strong></a></p>
  {% endif %}
  
 {% endblock %}
  